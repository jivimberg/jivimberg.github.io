<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Productivity | What I learned today]]></title>
  <link href="http://jivimberg.github.io/blog/categories/productivity/atom.xml" rel="self"/>
  <link href="http://jivimberg.github.io/"/>
  <updated>2016-12-07T10:24:26-08:00</updated>
  <id>http://jivimberg.github.io/</id>
  <author>
    <name><![CDATA[Juan Ignacio Vimberg]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Email Google Form Daily]]></title>
    <link href="http://jivimberg.github.io/blog/2014/08/21/email-google-form-daily/"/>
    <updated>2014-08-21T23:18:14-07:00</updated>
    <id>http://jivimberg.github.io/blog/2014/08/21/email-google-form-daily</id>
    <content type="html"><![CDATA[<p>Here I&rsquo;ll show you how you can email a Google Form daily, weekly or whatever. I&rsquo;ll achieve this by using <a href="https://developers.google.com/apps-script/">Google App Scripts</a>. Here we go</p>

<!--more-->


<p>1 &ndash; Create a Form (If you don&rsquo;t know how maybe this guide is a little bit too advanced for you, anyway you can start <a href="https://support.google.com/docs/answer/87809?hl=en">here</a>).</p>

<p>2 &ndash; Send this form to your email address using the <strong>Send Form</strong> button. Send it using the <strong>&ldquo;send form via email&rdquo;</strong> option, as shown in the picture:</p>

<p><img class="center" src="/images/posts/2014-08-21/SendForm.png" width="400" title="&lsquo;Send Form&rsquo;" ></p>

<p>3 &ndash; Now we need to get that form in HTML. To achieve this we will need the raw email. In GMail you can see it using the <strong>Show original</strong> option in the menu, from there you should copy everything that&rsquo;s enclosed in the <code>&lt;html&gt;...&lt;/html&gt;</code> tags (including the tags).</p>

<p><img class="center" src="/images/posts/2014-08-21/ShowOriginal.png" width="250" title="&lsquo;Show Original&rsquo;" ></p>

<p>4 &ndash; So we have the HTML but, at least if you obtain it like me, you&rsquo;ll notice that it is encoding as <strong>quoted-printable</strong>. I use <a href="http://www.webatic.com/run/convert/qp.php">this site</a> to decode it. Make sure you paste your code in the <strong>Encoded</strong> text field and press the <strong>decode</strong> button. Copy this code to your clipboard, we will need it later.</p>

<p>5 &ndash; Create a new Script from a Google Spreadsheet <em>( Tools > Script Manager&hellip; > New )</em>.</p>

<p>6 &ndash; In the Script Editor create a new HTML file <em>( File > New > Html file )</em> and paste your code from step 4. Once pasted remember to save the file. If you&rsquo;re seeing a red asterisk <span style="color:red"><em>*</em></span> by the name of the file that means it&rsquo;s not saved.</p>

<p>7 &ndash; In the <em>*.gs</em> paste the following code:</p>

<p>``` javascript
function sendFormEmail() {</p>

<pre><code>var toEmailAddress = "someone@gmail.com";  
var htmlMessage = HtmlService.createHtmlOutputFromFile("Name-of-your-HTML-file.html").getContent();
var subject = "Subject";
var message = "Some message";
MailApp.sendEmail(toEmailAddress, subject, message, {
  htmlBody: htmlMessage
});
</code></pre>

<p>}
```</p>

<p>Make sure your replace all the fields with the actual values!</p>

<p>8 &ndash; Give it a go and run it once to see if it worked.</p>

<p>9 &ndash; Finally go to <em>Resources > Current project triggers'</em>  and create a time driven trigger to run it daily (or weekly, or whatever suits your needs)<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p>

<p><img class="center" src="/images/posts/2014-08-21/Triggers.png" width="700" title="&lsquo;Triggers&rsquo;" ></p>

<p>9 (option B) &ndash; As <strong>an alternative</strong> you can define the triggers in the script itself using code as suggested by <a href="https://disqus.com/by/johannesschwaninger/">Johannes Schwaninger</a> in the comments. You can do so like this:</p>

<p>``` javascript
function createTimeDrivenTriggers() {
 // Trigger every day at 6 pm.</p>

<pre><code>  ScriptApp.newTrigger('sendFormEmail')
  .timeBased()
  .atHour(18)
  .everyDays(1) // Frequency is required if you are using atHour() or nearMinute()
  .create();
</code></pre>

<p>}
```</p>

<p>10 &ndash; Relax and enjoy!</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>If you’re not seeing the <em>time driven</em> option check that you’re accessing the script editor from a Spreadsheet and not from a Form. Or else just use the code alternative.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

]]></content>
  </entry>
  
</feed>
